<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>代销服务申请</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"/>
		<link rel="stylesheet" href="lib/all.css" />
		<link rel="stylesheet" href="lib/css.css" />
		<style>
			body{
				background: #f3f5fe;
				font-size: 0.24rem;
			}		
			.goodsWarehouse-address{
				 height:100%; !important;
				 width: 100%;
				 background: #FFFFFF;
			}	
			.goodsWarehouse-address-in{
				width: 100%;
				height:100%; !important;
				margin-top: 3px;
				padding-left: 0.3rem;
				padding-right: 0.3rem;
				background: #FFFFFF;
				word-wrap: break-word;
				display:none;
			}	
			header{
				width: 100%;
				height: 0.68rem;
				line-height: 0.68rem;
				padding-left: 0.36rem;
				font-size: 0.2rem;
			}	
			.addr-choose-in select{
				width: 32%;
				height: 0.68rem;
				outline: none;
				border: none;
				background: #F3F5FE;
				border-radius: 0.08rem;
				font-size: 0.15rem;
				/*color: #CDCCCD;*/
			}
			.otherpromise{
				margin-top: 0.2rem;
			}
			.otherpromise-in input{
				width: 90%;
				outline: none;
				border: none;
			}	
			.deal{
				text-align: center;
				height: 1.32rem;
				line-height: 1.32rem;
				margin-top: 0.7rem;
			}
			.deal>span:first-of-type{
				display: inline-block;
				width: 0.44rem;
				height: 0.44rem;
				background-size: 0.44rem 0.44rem;
				margin-right: 0.25rem;
			}
			.dealno{
				background: url(images/3.png) no-repeat center center;
				
			}
			.dealyes{
				background: url(images/1.png) no-repeat center center;
			}
			.deal>span{
				vertical-align: middle;
				font-size: 0.18rem;
			}
			.deal>a{
				vertical-align: middle;
				font-size: 0.18rem;
				color: #03dcc5;
			}		
		</style>
		<script src="lib/common.js"></script>
		<script type="text/javascript" src="lib/selfFit.js" ></script>
		<script type="text/javascript" src="lib/jquery-2.2.4.min.js" ></script>
		<script type="text/javascript" src="lib/distpicker.js" ></script>
		<script src="lib/common.js"></script>
		<script type="text/javascript" src="lib/arg-1.3.min.js"></script>
	</head>
	<body>

           <!--成功窗口-->
        <div id="result-success"> 
			<div class="result-bg"></div>
			<div class="result-show">
			     <div>
			     	<img src="images/4.png" id="result-pic" />
			     </div>
			     <div>
			     	<!--<p id="result-fail">失败原因——申请提交失败！</p>-->
			     	<p id="result-in">申请已提交！</p>
			     </div>
			</div>
		</div>

		 <!--失败窗口-->
        <div id="result-error"> 
			<div class="result-bg"></div>
			<div class="result-showfail">
			     <div>
			     	<img src="images/5.png" id="result-pic" />
			     </div>
			     <div>
			     	<p id="result-in">失败原因——申请提交失败！</p>
			     </div>
			</div>
		</div>

		<header>注：以下商品单价及总金额为含税17%。</header>
	   <!--  <div class="addr cell">
			<div class="addr-choose">
				<div>意向交货地址</div>
				<div class="addr-choose-in">
					<div data-toggle="distpicker">
					  <select data-province="省"></select>
					  <select data-city="市"></select>
					  <select data-district="区"></select>
					</div>
				</div>
			</div>
			<div class="addr-warehouse">
				<div>交货仓库</div>
				<div class="addr-warehouse-in">
					<select id="cells">
						<option>请选择交货仓库</option>
					</select>
				</div>
			</div>
		</div> -->
		<!-- <div>
			<div class="goodsWarehouse-address-in" id = "goodsWarehouse-address-in">		
			</div>
	    </div> -->
		<div class="goods">
			<div class="goods-model" style="display: none;">
				<div class="goods-box cell">

                    <div class="addr-choose">
				<div>意向交货地址</div>
				<div class="addr-choose-in">
					<div data-toggle="distpicker">
					  <select id ="provinceSelect" data-province="省"></select>
					  <select id ="citySelect" data-city="市"></select>
					  <select id ="districtSelect" data-district="区"></select>
					</div>
				</div>
			</div>
			<div class="addr-warehouse">
				<div>交货仓库</div>
				<div class="addr-warehouse-in">
					<select class = "cellsSelect"id="cells">
						<option>请选择交货仓库</option>
					</select>
				</div>
			</div>
             <div2 class="goodsWarehouse-address-in" id = "goodsWarehouse-address-in">		
			</div2>
					<div class="goods-info">
						<div>代销商品</div>
						<div class="goods-info-select">
							<div class="goods-info-select-type">
								<select class = "productTypeSelect"id = "productType">
									<option>商品类型</option>
								</select>
							</div>
							<div class="goods-info-select-name">
								<select  id="productNames">
									<option>商品名称</option>
								</select>
							</div>
						</div>
					</div>
					
					<div class="goods-price">
						<div>意向单价</div>
						<div class="goods-price-in goodsin">
							<div>
								<input type="text"   id="price" onKeyup="javascript:sendPrice(this);" onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}" onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"/>
							</div>
							<div>元/吨</div>
						</div>
					</div>
					<div class="goods-weight">
						<div>重量</div>
						<div class="goods-weight-in goodsin">
							<div>
								<input type="text" id="weight" onKeyup="javascript:sendWeight(this);" onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}" onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"/>
							</div>
							<div>吨</div>
						</div>
					</div>
					<div class="goods-num">
						<div>件数</div>
						<div class="goods-num-in goodsin">
							<div>
								<input type="text" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')"/>
							</div>
							<div></div>
						</div>
					</div>
					<div class="goods-total">
						<div>商品总价</div>
						<div class="goods-total-in goodsin" id = "totalPrice">
							<div>
								<input type="text" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')"/>
							</div>
							<div>元</div>
						</div>
					</div>
					<div class="goods-delete">删除此商品</div>
				</div>
			</div>

			<div class="good-wrap">
				<div class="goods-box cell">

                    <div class="addr-choose">
				<div>意向交货地址</div>
				<div class="addr-choose-in">
					<div data-toggle="distpicker">
					  <select id ="provinceSelectFirst" data-province="省"></select>
					  <select id ="citySelectFirst" data-city="市"></select>
					  <select id ="districtSelectFirst" data-district="区"></select>
					</div>
				</div>
			</div>
			<div class="addr-warehouse">
				<div>交货仓库</div>
				<div class="addr-warehouse-in">
					<select id="cellsFirst">
						<option>请选择交货仓库</option>
					</select>
				</div>
			</div>
                 <div2 class="goodsWarehouse-address-in" id = "goodsWarehouse-address-in-first">		
			</div2>
					<div class="goods-info">
						<div>代销商品</div>
						<div class="goods-info-select">
							<div class="goods-info-select-type">
								<select id="productTypeFirst">
									<option >商品类型</option>
								</select>
							</div>
							<div class="goods-info-select-name">
								<select id="productNamesFirst">
									<option>商品名称</option>
								</select>
							</div>
						</div>
					</div>
					
					<div class="goods-price">
						<div>意向单价</div>
						<div class="goods-price-in goodsin">
							<div>
								<input type="text"  id="price" onKeyup="javascript:sendPrice(this);" onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}" onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"/>
							</div>
							<div>元/吨</div>
						</div>
					</div>
					<div class="goods-weight">
						<div>重量</div>
						<div class="goods-weight-in goodsin">
							<div>
								<input type="text" id="weight" onKeyup="javascript:sendWeight(this);" onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}" onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"/>
							</div>
							<div>吨</div>
						</div>
					</div>
					<div class="goods-num">
						<div>件数</div>
						<div class="goods-num-in goodsin">
							<div>
								<input type="text" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')"/>
							</div>
							<div></div>
						</div>
					</div>



                    <div class="goods-total">
						<div>商品总价</div>
						<div class="goods-total-in goodsin" id = "totalPrice">
							<div>
								<input type="text" onkeyup="if(isNaN(value))execCommand('undo')" onafterpaste="if(isNaN(value))execCommand('undo')"/>
							</div>
							<div>元</div>
						</div>
					</div>
			<!-- <div class="otherpromise">
				<div>其他约定</div>
				<div class="otherpromise-in">
					<input type="text" />
				</div>
			</div>		 -->

				</div>
			</div>
			<div class="goods-add">
				+添加更多商品
			</div>
			<div class="other cell">
			    <div class="goods-convention">
					<div>特殊约定</div>
					<div class="goods-convention-in goodsin">
						<div>
							<input type="text" onafterpaste="if(isNaN(value))execCommand('undo')"/><!-- 去掉onkeyup="if(isNaN(value))execCommand('undo')"  -->
						</div>
						<div></div>
					</div>
				</div>
			</div>
		</div>
		<!-- <div class="otherpromise cell">
			<div>
				<div>其他约定</div>
				<div class="otherpromise-in">
					<input type="text" />
				</div>
			</div>		
		</div> -->
		<div class="deal">
			<span class="dealno"></span><span>已同意</span><a href="contractZSZY.html">《代销服务协议》</a>
		</div>
	    <div class="submit" id="submit">提交申请</div>
		
		<script>
			var add = $('.goods-add'),
			    foodWrap = $('.good-wrap'),
			    box = $('.goods-box'),
			    theDeal = $('.deal>span').eq(0);
			    submitBtn = $('#submit'); 
			    productTypeFirstBtn = $('#productTypeFirst');
			    suppilerWarehouse=[];
		    var mtn = theCommonFn.getMtnByUrl();
			    loginId = theCommonFn.getLoginIdByUrl(); 
			    fromType = theCommonFn.getFromTypeByUrl();
			    mobile = theCommonFn.getMobileByUrl();
                buildID = theCommonFn.getBuildIdByUrl();	
                loc = theCommonFn.getLocByUrl();
                versionID = theCommonFn.getVersionIDByUrl();
                
                // alert("mtn："+mtn );
                // alert("loginId："+ loginId );
                
			     //监听input窗口控制颜色变化
            $('.goods').on('focus','input',function(){
    		    $(this).css("background-color","#EDEDED");
            });
            $('.goods').on('blur','input',function(){
    		   $(this).css("background-color","#FFFFFF");
            });

         //添加list同时绑定select元素用以监听
 			add.click(function(){
				var theModel = $('.goods-model').children().clone();
				theModel.appendTo(foodWrap);
				$(".cellsSelect").change(function() {
            	 var wareHouseId = $(this).find("option:selected").attr("data-id");
                   for(var i =0; i < suppilerWarehouse.length; i++){
             	   	  console.log(wareHouseId);
             	   	  if (wareHouseId.toString() == suppilerWarehouse[i].houseId){
             	   	  	$(this).parent().parent().parent().find("#goodsWarehouse-address-in").text(suppilerWarehouse[i].houseAddress);
             	   	  	$(this).parent().parent().parent().find("#goodsWarehouse-address-in").show();
             	   	  }
             	    }
                 var info = $(this).parent().parent().parent().find("#productType");

             	    //类型信息列表
			$.ajax({
				type:"post",
				url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listProductType2Zy",
				async:true,
				data:{					
					loginId: loginId,
					mtn: mtn,
					// loginId: '82cc33cf3b35bda1705428551889c787',
					// mtn: 'uy4q4h8n31',
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID
				},
				beforeSend:function(){
				},
				success:function(rep){
					var reps;
					try{
						reps = JSON.parse(rep);	
						//console.log(rep);	
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
						var str = '',
						    list = reps.content;
						for(var i=0;i<list.length;i++){
							str += '<option data-id="'+list[i].product_type_id +'" >'+list[i].product_type_name+'</option>'
						};
						//console.log(str);
						info.append(str);
					}
				},
				error:function(){
					theCommonFn.alertWin('服务器出错')
				}
			});
             	   });

                $(".productTypeSelect").change(function() {
                	var firstSelect=$(this);  //产品类型选择框
                	var productTypeId = $(this).find("option:selected").attr("data-id");
                	var secondSelect=firstSelect.parent().siblings().children(); //产品名字选择框
                	var secondSelectParent = $(this).parent().siblings().find("option");//产品名字框上级属性，用来清除使用
                     getProductNameListNext(secondSelect,productTypeId,secondSelectParent);
                    //console.log("当前窗口为："+ $(this).find("option:selected").attr("data-id"));
                     //console.log("测试窗口为："+ $(this).parent().siblings().children());
                     // $(this).parent().siblings().children().find("option:checked").append('<option data-id="'+4+'" >'+'飞机4'+'</option>');
                     //secondSelect.append('<option data-id="'+4+'" >'+'飞机5'+'</option>');
                    // $('#productNames').append('<option data-id="'+3+'" >'+'飞机3'+'</option>');  //首行插入
                 //$(this).find("option:checked").append('<option data-id="'+4+'" >'+'飞机4'+'</option>');
                 //console.log( $(this).next());
                 // console.log( "这里是：" + $(this).find("option:checked").attr("data-id"));
                 // console.log( $('#productNamesFirst').next());
                });
			});

			foodWrap.on('click','.goods-delete',function(){
				$(this).parent().remove();
			});
			
			theDeal.click(function(){
				if($(this).hasClass('dealno')){
					$(this).removeClass('dealno').addClass('dealyes');
				}else{
					$(this).removeClass('dealyes').addClass('dealno');
				}
			});

			//获取存储仓库列表 -初始
			$.ajax({
				type:"post",
				url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listStorageHosue",
				async:true,
				data:{
					loginId: loginId,
					mtn: mtn,		
					// loginId: '82cc33cf3b35bda1705428551889c787',
					// mtn: 'uy4q4h8n31',
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID
				},
				beforeSend:function(){
				},
				success:function(rep){
					var reps;
					try{
						reps = JSON.parse(rep);		
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
						var str = '',
						    list = reps.content;
						for(var i=0;i<list.length;i++){
							str += '<option data-id="'+list[i].storeHouseId +'" >'+list[i].storeHouseName+'</option>',
							suppilerWarehouse.push({
								"houseId":list[i].storeHouseId,
								"houseName":list[i].storeHouseName,
								"houseAddress":list[i].address
							})
						};
						$('#cellsFirst').append(str);
					}
				},
				error:function(){
					theCommonFn.alertWin('服务器出错')
				}
			});

//获取存储仓库列表 -初始
			$.ajax({
				type:"post",
				url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listStorageHosue",
				async:true,
				data:{
					loginId: loginId,
					mtn: mtn,		
					// loginId: '82cc33cf3b35bda1705428551889c787',
					// mtn: 'uy4q4h8n31',
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID
				},
				beforeSend:function(){
				},
				success:function(rep){
					var reps;
					try{
						reps = JSON.parse(rep);		
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
						var str = '',
						    list = reps.content;
						for(var i=0;i<list.length;i++){
							str += '<option data-id="'+list[i].storeHouseId +'" >'+list[i].storeHouseName+'</option>',
							suppilerWarehouse.push({
								"houseId":list[i].storeHouseId,
								"houseName":list[i].storeHouseName,
								"houseAddress":list[i].address
							})
						};
						$('#cells').append(str);
					}
				},
				error:function(){
					var str = '<option data-id=1 >中国</option>'
						$('#cells').append(str);
					theCommonFn.alertWin('服务器出错')
				}
			});

//区仓库选择
             $("#districtSelectFirst").change(function() {   	
             	var province = $("#provinceSelect").find("option:selected").attr("data-code");
             	var city = $("#citySelect").find("option:selected").attr("data-code");
             	var district = $("#districtSelect").find("option:selected").attr("data-code");

             	   //交货仓库信息获取
             $.ajax({
				type:"post",
				url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listStroeByArea",
				async:true,
				data:{
					province:province,
					city:city,
					district:district,
					loginId: loginId,
					mtn: mtn,
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID
				},
				beforeSend:function(){
					//theCommonFn.waiting();
				},
				success:function(rep){
                      var reps;
					try{
						reps = JSON.parse(rep);		
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
						var str = '',
						    list = reps.content;
						for(var i=0;i<list.length;i++){
							str += '<option data-id="'+list[i].store_house_id +'" >'+list[i].store_house_name+'</option>',
							suppilerWarehouse.push({
								"houseId":list[i].store_house_id,
								"houseName":list[i].store_house_name,
								"houseAddress":list[i].address
							})
						};
					// 	$('#cells').append(str);
					};
					$('#goodsWarehouseId').append(str);
				},
				error:function(){
					theCommonFn.alertWin('服务器出错')
				}
			});
          });


//监听交货选择窗口，增添商品类型列表信息
            $("#cellsFirst").change(function() {
                 var wareHouseId = $(this).find("option:selected").attr("data-id");
                   for(var i =0; i < suppilerWarehouse.length; i++){
             	   	  console.log(wareHouseId);
             	   	  if (wareHouseId.toString() == suppilerWarehouse[i].houseId){
             	   	  	$("#goodsWarehouse-address-in-first").text(suppilerWarehouse[i].houseAddress);
             	   	  	$("#goodsWarehouse-address-in-first").show();
             	   	  }
             	   }

//商品类型信息列表
			// $.ajax({
			// 	type:"post",
			// 	url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listProductType2Zy",
			// 	async:true,
			// 	data:{					
			// 		loginId: loginId,
			// 		mtn: mtn,
			// 		// loginId: '82cc33cf3b35bda1705428551889c787',
			// 		// mtn: 'uy4q4h8n31',
			// 		fromType:fromType,
			// 		mobile:mobile,
			// 		buildID:buildID,
			// 		loc:loc,
			// 		versionID:versionID
			// 	},
			// 	beforeSend:function(){
			// 	},
			// 	success:function(rep){
			// 		var reps;
			// 		try{
			// 			reps = JSON.parse(rep);	
			// 			//console.log(rep);	
			// 		}catch(e){
			// 			//TODO handle the exception
			// 		};
			// 		if(reps.result){
			// 			var str = '',
			// 			    list = reps.content;
			// 			for(var i=0;i<list.length;i++){
			// 				str += '<option data-id="'+list[i].product_type_id +'" >'+list[i].product_type_name+'</option>'
			// 			};
			// 			$('#productTypeFirst').append(str);  //首行插入
			// 			//$('#productType').append(str);       //除了首行之外的其余行插入
			// 		}
			// 	},
			// 	error:function(){
			// 		theCommonFn.alertWin('服务器出错')
			// 	}
			// });

            });          

	// $("#goodsWarehouse-address-in").text("1134");
	//document.getElementById("goodsWarehouse-address-in").innerHTML="54123";
 //监听交货选择窗口，增添商品类型列表信息
            $("#cells").change(function() {
                 var wareHouseId = $(this).find("option:selected").attr("data-id");
                   for(var i =0; i < suppilerWarehouse.length; i++){
             	   	  console.log(wareHouseId);
             	   	  if (wareHouseId.toString() == suppilerWarehouse[i].houseId){
             	   	  	$("#goodsWarehouse-address-in").text(suppilerWarehouse[i].houseAddress);
             	   	  	$("#goodsWarehouse-address-in").show();
             	   	  }
             	   }
            });        

            //商品类型信息列表
			$.ajax({
				type:"post",
				url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listProductType2Zy",
				async:true,
				data:{					
					loginId: loginId,
					mtn: mtn,
					// loginId: '82cc33cf3b35bda1705428551889c787',
					// mtn: 'uy4q4h8n31',
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID
				},
				beforeSend:function(){
				},
				success:function(rep){
					var reps;
					try{
						reps = JSON.parse(rep);	
						//console.log(rep);	
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
						var str = '',
						    list = reps.content;
						for(var i=0;i<list.length;i++){
							str += '<option data-id="'+list[i].product_type_id +'" >'+list[i].product_type_name+'</option>'
						};
						$('#productTypeFirst').append(str);  //首行插入
						$('#productType').append(str);       //除了首行之外的其余行插入
					}
				},
				error:function(){
					theCommonFn.alertWin('服务器出错')
				}
			});  


               function sendWeight(inputobj){
               	    var goodsWeight = inputobj.value;
                    var jqueryinputobj = $(inputobj);
                    var goodsPrice = jqueryinputobj.parent().parent().parent().parent().find("#price").val();
                    jqueryinputobj.closest("div[class~=cell]").find("#totalPrice").html(goodsWeight*goodsPrice);
                 }

                function sendPrice(inputobj){
               	    var goodsPrice = inputobj.value;
                    var jqueryinputobj = $(inputobj);
                    var goodsWeight = jqueryinputobj.parent().parent().parent().parent().find("#weight").val();
               	    jqueryinputobj.closest("div[class~=cell]").find("#totalPrice").html(goodsWeight*goodsPrice);
                 }

           // $("select").change(function() {
           //       alert($(this).find("option:checked").attr("data-id"));
           //       getProductNameList();
           //       // $('#productNamesFirst').append('<option data-id="'+3+'" >'+'飞机3'+'</option>');  //首行插入
           //       // $(this).find("option:checked").append('<option data-id="'+4+'" >'+'飞机4'+'</option>');
           //       //console.log( $(this).next());
           //       console.log( "这里是：" + $(this).find("option:checked").attr("data-id"));
           //       console.log( $('#productNamesFirst').next());
           //  });

          //首框展示
          $("#productTypeFirst").change(function() {
          	     var productTypeId = $(this).find("option:selected").attr("data-id");
                 getProductNameList(productTypeId);
            });


           function getProductNameList(productTypeId){
                 $.ajax({
				type:"post",
				url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listProductByTypeId2Zy",
				async:true,
				data:{
					loginId: loginId,
					mtn: mtn,
					// 	loginId: '82cc33cf3b35bda1705428551889c787',
					// mtn: 'uy4q4h8n31',
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID,
					//supplier_id:'10',
					productTypeId:productTypeId
				},
				beforeSend:function(){
				},
				success:function(rep){
					var reps;
					try{
						reps = JSON.parse(rep);	
						//console.log(rep);	
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
						var str = '',
						    list = reps.content;
						for(var i=0;i<list.length;i++){
							str += '<option data-id="'+list[i].product_id +'" >'+list[i].product_name+'</option>'
						};
                             //str = '<option data-id="'+2+'" >'+'傻子'+'</option>';
						//$('#productNamesFirst').append('<option data-id="'+2+'" >'+'飞机'+'</option>');  //首行插入
						$('#productNamesFirst option').remove();//首框删除老的选择内容
						$('#productNamesFirst').append(str);  //首行插入
						//$('#productNames').append(str);       //除了首行之外的其余行插入
					}
				},
				error:function(){
					theCommonFn.alertWin('服务器出错')
				}
			});
           }

            function getProductNameListNext(secondSelect,productTypeId,secondSelectParent){
 	             var secondSelectObject = secondSelect;
 	             var productTypeIdResult = productTypeId;
 	             var secondSelectParentObject = secondSelectParent;

                 $.ajax({
				     type:"post",
				     url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=listProductByTypeId2Zy",
				      async:true,
				 data:{
					loginId: loginId,
					mtn: mtn,
					// 	loginId: '82cc33cf3b35bda1705428551889c787',
					// mtn: 'uy4q4h8n31',			
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID,
					//supplier_id:'10',
					productTypeId:productTypeIdResult
				},
				beforeSend:function(){
				},
				success:function(rep){
					var reps;
					try{
						reps = JSON.parse(rep);	
						//console.log(rep);	
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
						var str = '',
						    list = reps.content;
						for(var i=0;i<list.length;i++){
							str += '<option data-id="'+list[i].product_id +'" >'+list[i].product_name+'</option>'
						};
						secondSelectParentObject.remove();
                        secondSelectObject.append(str);
						//$('#productNames').append(str);  
					}
				},
				error:function(){
					theCommonFn.alertWin('服务器出错')
				}
			});
           }


             //交货仓库反向选择交货地址
             $("#cellsFirst").change(function() {
             	  //alert("123");
             	  var storehouserId = $(this).find("option:selected").attr("data-id");
             	  //alert(storehouserId);
              	  //获取仓库地址
             $.ajax({
				type:"post",
				url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=getAreaByStroseId",
				async:true,
				data:{
					storehouserId:storehouserId,
					loginId: loginId,
					mtn: mtn,
					fromType:fromType,
					mobile:mobile,
					buildID:buildID,
					loc:loc,
					versionID:versionID
				},
				beforeSend:function(){
					//theCommonFn.waiting();
				},
				success:function(rep){
                      var reps;
					try{
						reps = JSON.parse(rep);		
					}catch(e){
						//TODO handle the exception
					};
					if(reps.result){
                          list = reps.content;
                           var province = list.province;
                           var city = list.city;
                           var district = list.district;
                    
                           $("#provinceSelectFirst option[value="+province+"]").attr("selected", "selected");
                           $("#provinceSelectFirst").trigger("change");//刷新回显信息
                           $("#citySelectFirst option[value="+city+"]").attr("selected", true);
                           $("#citySelectFirst").trigger("change");//刷新回显信息
                           $("#districtSelectFirst option[value="+district+"]").attr("selected", true);
					};
				},
				error:function(){
					theCommonFn.alertWin('服务器出错')
				}
			});

             });

			submitBtn.click(function(){
                var isError = 0 ;
                var yueding = $('.goods-convention-in input').val();  
				if($('#cells').val()=='请选择交货仓库'){
					// theCommonFn.alertWin('请选择交货仓库');
					// return;
				}else{
					$('.good-wrap').find('input').each(function(i,item){
						if(!$(this).val()){
							theCommonFn.alertWin('请填写完整');
							isError = 1;
							return;
						}
					})
				};
           
                $('.good-wrap').find('input').each(function(i,item){
                    if(!$(this).val()){
							theCommonFn.alertWin('请填写完整');
							isError = 1;
							return;
						}
                });
                
	            if(theDeal.hasClass('dealno')){
				    theCommonFn.alertWin('您未同意储存协议');
				    return;
				}
									
                if(isError == '1'){
                	return;
                }

                var product=[],theData;
                for(var i=0;i<$('.good-wrap').find('.goods-box').length;i++){
                	var info = $('.good-wrap').find('.goods-box').eq(i);
                	var wareHouse  = $('.addr').find('.addr-warehouse').eq(i);
                	product.push({
                		"product_classify_id":$.trim(info.find('.goods-info-select-type select').find("option:checked").attr("data-id")),
		                "productTypeName":$.trim(info.find('.goods-info-select-type select').val()),
		                "storeHouseId":$.trim(wareHouse.find('.addr-warehouse-in select').val()),
		                "productid": $.trim(info.find('.goods-info-select-name select').find("option:checked").attr("data-id")),
		                "productname":$.trim(info.find('.goods-info-select-name select').val()),
		                "productnum":"商品编码",
		                "weight":$.trim(info.find('.goods-weight-in input').val()),
		                "unitprice	":$.trim(info.find('.goods-price-in input').val()),   //goods-price-in
		                "itemNumber":$.trim(info.find('.goods-num input').val()), //goods-num
		                "money":info.find('#totalPrice').html()
                		})
                }
                console.log(product);

                product = JSON.stringify(product);
            	$.ajax({
						type:"post",
				        url:"https://wei.wiyarn.com/actiz/rs/b?_s=coop&_m=createPledge",
				        async:true,
				            data:{
                              _vt:'dlk_weishatest',
					          loginId: loginId,
					          mtn: mtn,
					          fromType:fromType,
					          mobile:mobile,
					          buildID:buildID,
					          versionID:versionID,
					          //sign:'b92d3f53c061fafcfe8a1041b2cf4baf',
					          loc:loc,
					          product:product,
					          yueding:yueding
					          //junit:'元/吨',
					          //suppliername:'新疆利泰丝路投资有限公司'
				            },
				            success:function(rep){
				            	var reps;
								try{
									reps = JSON.parse(rep);		
								}catch(e){
									
								};
								if(reps.result){
										$("#result-success").show();
										theCommonFn.delay2('3000');
										theCommonFn.waitAndClosePrompts('1','7000');
										theCommonFn.delay2('5000');
										//window.navigate("www.baidu.com"); 
										//window.location="https://www.baidu.com";
								}else{
										$("#result-error").show();
										setTimeout("$('#result-error').hide();",3000);
								}
					   //     //theCommonFn.alertWin('提交成功');
					   //     //theCommonFn.windowPrompts();
					   //     $("#result-success").show();
					   //    // console.log("zoudoazhelile");
								// theCommonFn.delay2('3000');
								// theCommonFn.waitAndClosePrompts('1','3000');
				        }
				})
				// $("#result-success").show();
				// theCommonFn.waitAndClosePrompts('1','3000');
			});
		</script>
	</body>
</html>
